var RAGApp=(()=>{var{useState:et,useEffect:tt,useRef:at,forwardRef:st}=React,ze={database:"M3 3h18v18H3z M3 9h18 M3 15h18 M21 3v18 M3 3v18","building-2":"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2 M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2 M10 6h4 M10 10h4 M10 14h4 M10 18h4","chevron-down":"m6 9 6 6 6-6","chevron-left":"m15 18-6-6 6-6","chevron-right":"m9 18 6-6-6-6",check:"M20 6 9 17l-5-5","refresh-cw":"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8 M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16 M21 3v5h-5 M3 21v-5h5",search:"M19 19l-4-4m0-7A7 7 0 1 1 4 8a7 7 0 0 1 11 0z",upload:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4 M17 8l-5-5-5 5 M12 3v12","upload-cloud":"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242 M12 12v9 M8 17l4-4 4 4","file-text":"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z M14 2v6h6 M16 13H8 M16 17H8 M10 9H8","folder-plus":"M12 10v6 M9 13h6 M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z",eye:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z M12 9a3 3 0 1 0 0 6 3 3 0 0 0 0-6z",download:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4 M7 10l5 5 5-5 M12 15V3","trash-2":"M3 6h18 M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6 M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2 M10 11v6 M14 11v6","alert-circle":"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z M12 8v4 M12 16h.01","alert-triangle":"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z M12 9v4 M12 17h.01",x:"M18 6 6 18 M6 6l12 12","x-circle":"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z M15 9l-6 6 M9 9l6 6","check-circle":"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z M9 12l2 2 4-4",info:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z M12 16v-4 M12 8h.01","search-x":"M19 19l-4-4 M13.5 8.5L10.5 11.5 M10.5 8.5l3 3 M5 11a6 6 0 1 0 12 0 6 6 0 0 0-12 0z",sparkles:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z M20 3v4 M22 5h-4 M4 17v2 M5 18H3",image:"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z M8.5 10a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z M21 15l-5-5L5 21",file:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z M14 2v6h6",code:"m8 18 4-12h4 M8 6l-4 6 4 6 M16 6l4 6-4 6",braces:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5a2 2 0 0 0 2 2h1 M16 3h1a2 2 0 0 1 2 2v5a2 2 0 0 0 2 2 2 2 0 0 0-2 2v5a2 2 0 0 1-2 2h-1",table:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",inbox:"M22 12h-6l-2 3h-4l-2-3H2 M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",library:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20 M4 4.5A2.5 2.5 0 0 1 6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15z","user-x":"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2 M8.5 3a4 4 0 1 0 0 8 4 4 0 0 0 0-8z M18 8l5 5 M23 8l-5 5",folder:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z",calendar:"M19 4H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 0V2m-14 2V2m0 6h14",plus:"M12 5v14M5 12h14",settings:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z M12 9a3 3 0 1 0 0 6 3 3 0 0 0 0-6z",user:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2 M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z",grid:"M3 3h7v7H3z M14 3h7v7h-7z M14 14h7v7h-7z M3 14h7v7H3z",history:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8 M3 3v5h5 M12 7v5l4 2",clock:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z M12 6v6l4 2",zap:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",text:"M17 6.1H3 M21 12.1H3 M15.1 18H3","bar-chart-3":"M3 3v18h18 M18 17V9 M13 17V5 M8 17v-3","bar-chart":"M12 20V10 M18 20V4 M6 20v-4",activity:"M22 12h-4l-3 9L9 3l-3 9H2"};function r({name:t,className:e="",size:a,...n}){let i=ze[t];return i?React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:a||24,height:a||24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,...n},React.createElement("path",{d:i})):(console.warn(`Icon "${t}" not found`),React.createElement("span",{className:e}))}function B({children:t,variant:e="default",size:a="default",disabled:n=!1,loading:i=!1,className:y="",onClick:C,...d}){let h="inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",l={default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90"},u={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3 text-sm",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"};return React.createElement("button",{type:"button",className:`${h} ${l[e]} ${u[a]} ${y}`,disabled:n||i,onClick:C,...d},i&&React.createElement("svg",{className:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),t)}function J({type:t="text",className:e="",error:a=!1,...n}){return React.createElement("input",{type:t,className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${a?"border-destructive focus-visible:ring-destructive":""} ${e}`,...n})}function de({children:t,className:e="",...a}){return React.createElement("select",{className:`flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${e}`,...a},t)}function se({children:t,className:e="",hover:a=!1,...n}){return React.createElement("div",{className:`rounded-lg border bg-card text-card-foreground shadow-sm ${a?"card-hover cursor-pointer":""} ${e}`,...n},t)}function me({children:t,className:e="",...a}){return React.createElement("div",{className:`flex flex-col space-y-1.5 p-6 ${e}`,...a},t)}function ue({children:t,className:e="",...a}){return React.createElement("h3",{className:`text-2xl font-semibold leading-none tracking-tight ${e}`,...a},t)}function ge({children:t,className:e="",...a}){return React.createElement("p",{className:`text-sm text-muted-foreground ${e}`,...a},t)}function ne({children:t,className:e="",...a}){return React.createElement("div",{className:`p-6 pt-0 ${e}`,...a},t)}function re({children:t,variant:e="default",className:a="",...n}){return React.createElement("div",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors ${{default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input bg-background hover:bg-accent",success:"bg-success text-success-foreground"}[e]} ${a}`,...n},t)}function pe({children:t,value:e,onValueChange:a,className:n=""}){return React.createElement("div",{className:`${n}`,"data-value":e},React.Children.map(t,i=>React.isValidElement(i)?React.cloneElement(i,{activeTab:e,onTabChange:a}):i))}function fe({children:t,className:e="",activeTab:a,onTabChange:n}){return React.createElement("div",{className:`inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${e}`},React.Children.map(t,i=>React.isValidElement(i)?React.cloneElement(i,{activeTab:a,onTabChange:n}):i))}function Z({children:t,value:e,className:a="",activeTab:n,onTabChange:i}){return React.createElement("button",{className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ${n===e?"bg-background text-foreground shadow-sm":"hover:bg-background/50 hover:text-foreground"} ${a}`,onClick:()=>i?.(e)},t)}function ee({children:t,value:e,className:a="",activeTab:n}){return n!==e?null:React.createElement("div",{className:`mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 animate-fade-in ${a}`},t)}function q({children:t,variant:e="default",className:a="",...n}){return React.createElement("div",{role:"alert",className:`relative w-full rounded-lg border p-4 ${{default:"bg-background border",destructive:"border-destructive/50 text-destructive bg-destructive/10",success:"border-success/50 text-success bg-success/10",warning:"border-yellow-500/50 text-yellow-700 bg-yellow-50"}[e]} ${a}`,...n},t)}function Q({children:t,className:e="",...a}){return React.createElement("h5",{className:`mb-1 font-medium leading-none tracking-tight ${e}`,...a},t)}function K({children:t,className:e="",...a}){return React.createElement("div",{className:`text-sm [&_p]:leading-relaxed ${e}`,...a},t)}function Re({message:t,type:e="info",onClose:a}){let n={info:"bg-background border",success:"bg-success/10 border-success/50 text-success",error:"bg-destructive/10 border-destructive/50 text-destructive",warning:"bg-yellow-50 border-yellow-500/50 text-yellow-700"},i={info:"info",success:"check-circle",error:"x-circle",warning:"alert-triangle"};return React.createElement("div",{className:`flex items-center gap-3 rounded-lg border p-4 shadow-lg toast-enter ${n[e]}`},React.createElement(r,{name:i[e],className:"h-5 w-5"}),React.createElement("span",{className:"text-sm font-medium"},t),React.createElement("button",{onClick:a,className:"ml-auto rounded-md p-1 hover:bg-muted"},React.createElement(r,{name:"x",className:"h-4 w-4"})))}function xe({toasts:t,onRemove:e}){return React.createElement("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2"},t.map(a=>React.createElement(Re,{key:a.id,message:a.message,type:a.type,onClose:()=>e(a.id)})))}function X({icon:t="inbox",title:e,description:a,action:n}){return React.createElement("div",{className:"flex flex-col items-center justify-center py-12 text-center"},React.createElement("div",{className:"rounded-full bg-muted p-4 mb-4"},React.createElement(r,{name:t,className:"h-8 w-8 text-muted-foreground"})),React.createElement("h3",{className:"text-lg font-semibold"},e),a&&React.createElement("p",{className:"text-sm text-muted-foreground mt-1 max-w-sm"},a),n&&React.createElement("div",{className:"mt-4"},n))}var{useState:oe,useCallback:V,useRef:ve}=React,Fe={"application/pdf":{icon:"file-text",label:"PDF"},"text/plain":{icon:"file-text",label:"TXT"},"text/markdown":{icon:"file-text",label:"MD"},"text/html":{icon:"code",label:"HTML"},"application/json":{icon:"braces",label:"JSON"},"text/csv":{icon:"table",label:"CSV"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{icon:"file-text",label:"DOCX"},"application/msword":{icon:"file-text",label:"DOC"},"image/png":{icon:"image",label:"PNG"},"image/jpeg":{icon:"image",label:"JPG"},"image/gif":{icon:"image",label:"GIF"},"image/webp":{icon:"image",label:"WEBP"}},je=10*1024*1024;function be({onFilesSelected:t,onUpload:e,accept:a="*/*",multiple:n=!0,maxFiles:i=10,disabled:y=!1,uploading:C=!1,progress:d=0,className:h=""}){let[l,u]=oe(!1),[p,S]=oe([]),[N,o]=oe([]),m=ve(null),x=ve(0),_=V(f=>{let F=[];f.size>je&&F.push("File exceeds 10MB limit");let P=[".exe",".bat",".cmd",".com",".scr",".vbs",".js"],L=f.name.toLowerCase().slice(f.name.lastIndexOf("."));return P.includes(L)&&F.push("File type not allowed for security reasons"),F},[]),$=V(f=>{let F=[],P=[];if(Array.from(f).slice(0,i-p.length).forEach((L,k)=>{let z=_(L);if(z.length>0)P.push({name:L.name,errors:z});else{let c=L.type.startsWith("image/"),A={id:`${Date.now()}-${k}`,file:L,name:L.name,size:L.size,type:L.type,isImage:c,preview:c?URL.createObjectURL(L):null,typeInfo:Fe[L.type]||{icon:"file",label:"FILE"}};F.push(A)}}),F.length>0){let L=[...p,...F];S(L),t?.(L.map(k=>k.file))}P.length>0&&(o(P),setTimeout(()=>o([]),5e3))},[p,i,_,t]),T=V(f=>{f.preventDefault(),f.stopPropagation(),x.current++,f.dataTransfer.items&&f.dataTransfer.items.length>0&&u(!0)},[]),s=V(f=>{f.preventDefault(),f.stopPropagation(),x.current--,x.current===0&&u(!1)},[]),b=V(f=>{f.preventDefault(),f.stopPropagation()},[]),w=V(f=>{if(f.preventDefault(),f.stopPropagation(),u(!1),x.current=0,y)return;let F=f.dataTransfer.files;F.length>0&&$(F)},[y,$]),M=V(f=>{let F=f.target.files;F.length>0&&$(F),f.target.value=""},[$]),v=V(f=>{S(F=>{let P=F.filter(k=>k.id!==f),L=F.find(k=>k.id===f);return L?.preview&&URL.revokeObjectURL(L.preview),t?.(P.map(k=>k.file)),P})},[t]),g=V(()=>{p.forEach(f=>{f.preview&&URL.revokeObjectURL(f.preview)}),S([]),t?.([])},[p,t]),D=f=>f<1024?`${f} B`:f<1024*1024?`${(f/1024).toFixed(1)} KB`:`${(f/(1024*1024)).toFixed(1)} MB`,E=V(()=>{p.length>0&&e&&e(p.map(f=>f.file))},[p,e]);return React.createElement("div",{className:`space-y-4 ${h}`},React.createElement("div",{className:`drop-zone relative rounded-lg p-8 text-center transition-all ${l?"dragover":""} ${y?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onDragEnter:T,onDragLeave:s,onDragOver:b,onDrop:w,onClick:()=>!y&&m.current?.click()},React.createElement("input",{ref:m,type:"file",accept:a,multiple:n,onChange:M,className:"hidden",disabled:y}),React.createElement("div",{className:"flex flex-col items-center gap-3"},React.createElement("div",{className:`rounded-full p-4 ${l?"bg-primary/10":"bg-muted"}`},React.createElement(r,{name:"upload-cloud",className:`h-8 w-8 ${l?"text-primary":"text-muted-foreground"}`})),React.createElement("div",null,React.createElement("p",{className:"text-sm font-medium"},l?"Drop files here":"Drag & drop files here"),React.createElement("p",{className:"text-xs text-muted-foreground mt-1"},"or click to browse (max ",i," files, 10MB each)")),React.createElement("div",{className:"flex flex-wrap gap-1 justify-center mt-2"},["PDF","TXT","MD","DOCX","JSON","CSV"].map(f=>React.createElement("span",{key:f,className:"text-xs px-2 py-0.5 bg-muted rounded-full text-muted-foreground"},f)),React.createElement("span",{className:"text-xs px-2 py-0.5 bg-primary/10 text-primary rounded-full"},"Images (coming soon)")))),N.length>0&&React.createElement("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-3"},React.createElement("div",{className:"flex items-start gap-2"},React.createElement(r,{name:"alert-circle",className:"h-4 w-4 text-destructive mt-0.5"}),React.createElement("div",{className:"text-sm"},N.map((f,F)=>React.createElement("p",{key:F,className:"text-destructive"},React.createElement("span",{className:"font-medium"},f.name,":")," ",f.errors.join(", ")))))),p.length>0&&React.createElement("div",{className:"space-y-2"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-medium"},p.length," file",p.length>1?"s":""," selected"),React.createElement("button",{onClick:g,className:"text-xs text-muted-foreground hover:text-foreground",disabled:C},"Clear all")),React.createElement("div",{className:"grid gap-2"},p.map(f=>React.createElement("div",{key:f.id,className:"flex items-center gap-3 p-3 rounded-lg border bg-card"},f.isImage&&f.preview?React.createElement("img",{src:f.preview,alt:f.name,className:"h-10 w-10 rounded object-cover"}):React.createElement("div",{className:"h-10 w-10 rounded bg-muted flex items-center justify-center"},React.createElement(r,{name:f.typeInfo.icon,className:"h-5 w-5 text-muted-foreground"})),React.createElement("div",{className:"flex-1 min-w-0"},React.createElement("p",{className:"text-sm font-medium truncate"},f.name),React.createElement("p",{className:"text-xs text-muted-foreground"},f.typeInfo.label," \u2022 ",D(f.size))),!C&&React.createElement("button",{onClick:F=>{F.stopPropagation(),v(f.id)},className:"p-1 rounded hover:bg-muted"},React.createElement(r,{name:"x",className:"h-4 w-4 text-muted-foreground"}))))),C&&React.createElement("div",{className:"space-y-2"},React.createElement("div",{className:"h-2 rounded-full bg-secondary overflow-hidden"},React.createElement("div",{className:"h-full bg-primary transition-all progress-bar",style:{width:`${d}%`}})),React.createElement("p",{className:"text-xs text-center text-muted-foreground"},"Uploading... ",d,"%")),!C&&e&&React.createElement("button",{onClick:E,disabled:p.length===0,className:"w-full h-10 px-4 py-2 rounded-md bg-primary text-primary-foreground font-medium hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},"Upload ",p.length," file",p.length>1?"s":"")))}var{useState:te,useCallback:it,useMemo:ct}=React,Ee=[{value:"",label:"All Categories"},{value:"brand_voice",label:"Brand Voice"},{value:"brand_guidelines",label:"Brand Guidelines"},{value:"content_pillars",label:"Content Pillars"},{value:"marketing_strategy",label:"Marketing Strategy"},{value:"product",label:"Product"},{value:"target_audience",label:"Target Audience"},{value:"past_campaign",label:"Past Campaign"},{value:"seasonal_themes",label:"Seasonal Themes"},{value:"general",label:"General"}];function he({documents:t=[],loading:e=!1,error:a=null,pagination:n={page:1,limit:20,total:0},onPageChange:i,onDelete:y,onView:C,onExport:d,onRefresh:h,onRetry:l,onSwitchToUpload:u}){let[p,S]=te(""),[N,o]=te(""),[m,x]=te(null),[_,$]=te(!1),T=t.filter(g=>{let D=p.toLowerCase(),E=g.title?.toLowerCase().includes(D)||g.source_type?.toLowerCase().includes(D)||g.tags?.some(F=>F.toLowerCase().includes(D)),f=!N||g.source_type===N;return E&&f}),s=g=>g?new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown",b=g=>g?g<1e3?`${g} chars`:`${(g/1e3).toFixed(1)}k chars`:"Unknown",w=g=>{let D={brand_voice:"bg-indigo-100 text-indigo-700",brand_guidelines:"bg-purple-100 text-purple-700",content_pillars:"bg-cyan-100 text-cyan-700",marketing_strategy:"bg-blue-100 text-blue-700",product:"bg-green-100 text-green-700",target_audience:"bg-amber-100 text-amber-700",past_campaign:"bg-orange-100 text-orange-700",seasonal_themes:"bg-rose-100 text-rose-700",general:"bg-gray-100 text-gray-700"};return D[g]||D.general},M=async g=>{$(!0);try{await y?.(g.id),x(null)}finally{$(!1)}},v=Math.ceil(n.total/n.limit);return React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"flex items-center justify-between gap-4"},React.createElement("div",{className:"flex items-center gap-3 flex-1"},React.createElement("div",{className:"relative flex-1 max-w-sm"},React.createElement(r,{name:"search",className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),React.createElement("input",{type:"text",placeholder:"Search documents...",value:p,onChange:g=>S(g.target.value),className:"w-full h-10 pl-10 pr-4 rounded-md border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-ring"})),React.createElement("select",{value:N,onChange:g=>o(g.target.value),className:"h-10 px-3 rounded-md border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-ring"},Ee.map(g=>React.createElement("option",{key:g.value,value:g.value},g.label)))),React.createElement("button",{onClick:h,disabled:e,className:"h-10 px-4 rounded-md border border-input bg-background hover:bg-accent transition-colors disabled:opacity-50"},React.createElement(r,{name:"refresh-cw",className:`h-4 w-4 ${e?"animate-spin":""}`}))),React.createElement("div",{className:"flex items-center gap-4 text-sm text-muted-foreground"},React.createElement("span",null,n.total," documents"),React.createElement("span",null,"\u2022"),React.createElement("span",null,"Page ",n.page," of ",v||1)),a&&React.createElement("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4 mb-4"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement(r,{name:"alert-circle",className:"h-5 w-5 text-destructive flex-shrink-0"}),React.createElement("div",null,React.createElement("p",{className:"text-sm font-medium text-destructive"},"Failed to load documents"),React.createElement("p",{className:"text-xs text-muted-foreground mt-0.5"},a))),React.createElement("button",{onClick:l||h,className:"h-8 px-3 rounded-md bg-destructive/10 hover:bg-destructive/20 text-destructive text-sm font-medium transition-colors"},"Retry"))),React.createElement("div",{className:"relative"},e&&t.length>0&&React.createElement("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center z-10 rounded-lg"},React.createElement("div",{className:"flex items-center gap-2 bg-card px-4 py-2 rounded-full shadow-sm border"},React.createElement("svg",{className:"animate-spin h-4 w-4 text-primary",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),React.createElement("span",{className:"text-sm text-muted-foreground"},"Refreshing..."))),e&&t.length===0&&!a?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center gap-2 mb-2"},React.createElement("svg",{className:"animate-spin h-4 w-4 text-primary",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),React.createElement("span",{className:"text-sm text-muted-foreground"},"Loading documents...")),[1,2,3].map(g=>React.createElement("div",{key:g,className:"skeleton h-20 rounded-lg"}))):!e&&!a&&T.length===0?React.createElement("div",{className:"flex flex-col items-center justify-center py-12 text-center"},React.createElement("div",{className:"rounded-full bg-muted p-4 mb-4"},React.createElement(r,{name:p||N?"search-x":"folder-plus",className:"h-8 w-8 text-muted-foreground"})),React.createElement("h3",{className:"text-lg font-semibold"},p||N?"No matching documents":"No documents yet"),React.createElement("p",{className:"text-sm text-muted-foreground mt-1 mb-4"},p||N?"Try a different search term or clear your filters":"Get started by uploading your first document for this client"),!p&&!N&&u&&React.createElement("button",{onClick:u,className:"h-10 px-4 rounded-md bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 flex items-center gap-2"},React.createElement(r,{name:"upload",className:"h-4 w-4"}),"Upload Your First Document"),(p||N)&&React.createElement("button",{onClick:()=>{S(""),o("")},className:"h-10 px-4 rounded-md border border-input bg-background hover:bg-accent text-sm font-medium"},"Clear Filters")):!a&&React.createElement("div",{className:"space-y-2"},T.map(g=>React.createElement("div",{key:g.id,className:"group flex items-start gap-4 p-4 rounded-lg border bg-card hover:shadow-sm transition-all"},React.createElement("div",{className:"rounded-lg bg-muted p-2"},React.createElement(r,{name:"file-text",className:"h-5 w-5 text-muted-foreground"})),React.createElement("div",{className:"flex-1 min-w-0"},React.createElement("div",{className:"flex items-start justify-between gap-2"},React.createElement("h4",{className:"font-medium truncate"},g.title||"Untitled"),React.createElement("span",{className:`text-xs px-2 py-0.5 rounded-full ${w(g.source_type)}`},g.source_type?.replace(/_/g," ")||"general")),React.createElement("div",{className:"flex items-center gap-3 mt-1 text-sm text-muted-foreground"},React.createElement("span",null,s(g.created_at)),React.createElement("span",null,"\u2022"),React.createElement("span",null,b(g.size))),g.tags&&g.tags.length>0&&React.createElement("div",{className:"flex flex-wrap gap-1 mt-2"},g.tags.slice(0,5).map((D,E)=>React.createElement("span",{key:E,className:"text-xs px-2 py-0.5 rounded-full bg-secondary text-secondary-foreground"},D)),g.tags.length>5&&React.createElement("span",{className:"text-xs text-muted-foreground"},"+",g.tags.length-5," more"))),React.createElement("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},React.createElement("button",{onClick:()=>C?.(g),className:"p-2 rounded-md hover:bg-muted",title:"View document"},React.createElement(r,{name:"eye",className:"h-4 w-4 text-muted-foreground"})),React.createElement("button",{onClick:()=>d?.(g,"json"),className:"p-2 rounded-md hover:bg-muted",title:"Export"},React.createElement(r,{name:"download",className:"h-4 w-4 text-muted-foreground"})),React.createElement("button",{onClick:()=>x(g),className:"p-2 rounded-md hover:bg-destructive/10",title:"Delete"},React.createElement(r,{name:"trash-2",className:"h-4 w-4 text-destructive"})))))))," ",v>1&&React.createElement("div",{className:"flex items-center justify-center gap-2"},React.createElement("button",{onClick:()=>i?.(n.page-1),disabled:n.page<=1,className:"h-8 w-8 rounded-md border border-input bg-background hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed"},React.createElement(r,{name:"chevron-left",className:"h-4 w-4 mx-auto"})),Array.from({length:Math.min(5,v)},(g,D)=>{let E;return v<=5||n.page<=3?E=D+1:n.page>=v-2?E=v-4+D:E=n.page-2+D,React.createElement("button",{key:E,onClick:()=>i?.(E),className:`h-8 w-8 rounded-md text-sm font-medium ${E===n.page?"bg-primary text-primary-foreground":"border border-input bg-background hover:bg-accent"}`},E)}),React.createElement("button",{onClick:()=>i?.(n.page+1),disabled:n.page>=v,className:"h-8 w-8 rounded-md border border-input bg-background hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed"},React.createElement(r,{name:"chevron-right",className:"h-4 w-4 mx-auto"}))),m&&React.createElement("div",{className:"fixed inset-0 z-50"},React.createElement("div",{className:"fixed inset-0 bg-black/80",onClick:()=>!_&&x(null)}),React.createElement("div",{className:"fixed inset-0 flex items-center justify-center p-4"},React.createElement("div",{className:"bg-background rounded-lg shadow-lg max-w-md w-full p-6 animate-fade-in"},React.createElement("div",{className:"flex items-center gap-3 mb-4"},React.createElement("div",{className:"rounded-full bg-destructive/10 p-2"},React.createElement(r,{name:"alert-triangle",className:"h-5 w-5 text-destructive"})),React.createElement("h3",{className:"text-lg font-semibold"},"Delete Document")),React.createElement("p",{className:"text-sm text-muted-foreground mb-6"},"Are you sure you want to delete ",React.createElement("strong",null,'"',m.title,'"'),"? This action cannot be undone."),React.createElement("div",{className:"flex justify-end gap-2"},React.createElement("button",{onClick:()=>x(null),disabled:_,className:"h-10 px-4 rounded-md border border-input bg-background hover:bg-accent disabled:opacity-50"},"Cancel"),React.createElement("button",{onClick:()=>M(m),disabled:_,className:"h-10 px-4 rounded-md bg-destructive text-destructive-foreground hover:bg-destructive/90 disabled:opacity-50"},_?React.createElement("span",{className:"flex items-center gap-2"},React.createElement("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),"Deleting..."):"Delete"))))))}var{useState:le}=React,Le=[{value:"GENERAL",label:"General",description:"Search all documents"},{value:"STRATEGY",label:"Strategy",description:"Brand voice + past campaigns"},{value:"BRIEF",label:"Brief",description:"Product specs + brand voice"},{value:"VISUAL",label:"Visual",description:"Visual assets only"}];function ye({clientId:t,onSearch:e,results:a=[],loading:n=!1,error:i=null}){let[y,C]=le(""),[d,h]=le("GENERAL"),[l,u]=le(5),p=o=>{o.preventDefault(),y.trim()&&t&&e?.(y,d,l)},S=o=>typeof o!="number"?"N/A":`${(o*100).toFixed(0)}%`,N=o=>o>=.8?"text-success":o>=.5?"text-yellow-600":"text-muted-foreground";return React.createElement("div",{className:"space-y-6"},React.createElement("form",{onSubmit:p,className:"space-y-4"},React.createElement("div",null,React.createElement("label",{className:"block text-sm font-medium mb-2"},"Search Query"),React.createElement("div",{className:"relative"},React.createElement("input",{type:"text",value:y,onChange:o=>C(o.target.value),placeholder:"e.g., What is the brand voice for email campaigns?",className:"w-full h-12 pl-4 pr-12 rounded-lg border border-input bg-background text-base focus:outline-none focus:ring-2 focus:ring-ring",disabled:!t}),React.createElement("button",{type:"submit",disabled:!y.trim()||!t||n,className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"},n?React.createElement("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})):React.createElement(r,{name:"search",className:"h-4 w-4"})))),React.createElement("div",{className:"flex flex-wrap gap-4"},React.createElement("div",{className:"flex-1 min-w-[200px]"},React.createElement("label",{className:"block text-sm font-medium mb-2"},"Search Phase"),React.createElement("select",{value:d,onChange:o=>h(o.target.value),className:"w-full h-10 px-3 rounded-md border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-ring"},Le.map(o=>React.createElement("option",{key:o.value,value:o.value},o.label," - ",o.description)))),React.createElement("div",{className:"w-32"},React.createElement("label",{className:"block text-sm font-medium mb-2"},"Results"),React.createElement("select",{value:l,onChange:o=>u(parseInt(o.target.value)),className:"w-full h-10 px-3 rounded-md border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-ring"},[3,5,10,15,20].map(o=>React.createElement("option",{key:o,value:o},"Top ",o)))))),i&&React.createElement("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement(r,{name:"alert-circle",className:"h-5 w-5 text-destructive mt-0.5"}),React.createElement("div",null,React.createElement("p",{className:"font-medium text-destructive"},"Search Error"),React.createElement("p",{className:"text-sm text-destructive/80 mt-1"},i)))),!t&&React.createElement("div",{className:"rounded-lg border border-yellow-500/50 bg-yellow-50 p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement(r,{name:"alert-triangle",className:"h-5 w-5 text-yellow-600 mt-0.5"}),React.createElement("div",null,React.createElement("p",{className:"font-medium text-yellow-700"},"No Client Selected"),React.createElement("p",{className:"text-sm text-yellow-600 mt-1"},"Please select a client to test intelligence search.")))),a.length>0&&React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"font-medium"},"Search Results"),React.createElement("span",{className:"text-sm text-muted-foreground"},a.length," results")),React.createElement("div",{className:"space-y-3"},a.map((o,m)=>React.createElement("div",{key:m,className:"rounded-lg border bg-card p-4 hover:shadow-sm transition-all"},React.createElement("div",{className:"flex items-start justify-between gap-4 mb-3"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"flex items-center justify-center h-6 w-6 rounded-full bg-primary/10 text-primary text-xs font-medium"},m+1),React.createElement("span",{className:"text-sm font-medium"},o.metadata?.title||"Untitled Document")),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:`text-sm font-medium ${N(o.relevance_score)}`},S(o.relevance_score)),React.createElement("span",{className:"text-xs px-2 py-0.5 rounded-full bg-muted text-muted-foreground"},o.metadata?.category||"general"))),React.createElement("div",{className:"bg-muted/50 rounded-md p-3"},React.createElement("p",{className:"text-sm text-foreground/80 whitespace-pre-wrap"},o.content?.length>500?`${o.content.slice(0,500)}...`:o.content||"No content available")),o.metadata&&React.createElement("div",{className:"flex flex-wrap gap-2 mt-3"},o.metadata.source&&React.createElement("span",{className:"text-xs text-muted-foreground"},"Source: ",o.metadata.source)))))),!n&&a.length===0&&y&&t&&React.createElement("div",{className:"flex flex-col items-center justify-center py-12 text-center"},React.createElement("div",{className:"rounded-full bg-muted p-4 mb-4"},React.createElement(r,{name:"search-x",className:"h-8 w-8 text-muted-foreground"})),React.createElement("h3",{className:"text-lg font-semibold"},"No results found"),React.createElement("p",{className:"text-sm text-muted-foreground mt-1 max-w-sm"},"Try adjusting your search query or changing the search phase.")),!n&&a.length===0&&!y&&t&&React.createElement("div",{className:"flex flex-col items-center justify-center py-12 text-center"},React.createElement("div",{className:"rounded-full bg-muted p-4 mb-4"},React.createElement(r,{name:"sparkles",className:"h-8 w-8 text-muted-foreground"})),React.createElement("h3",{className:"text-lg font-semibold"},"Test Intelligence Hub"),React.createElement("p",{className:"text-sm text-muted-foreground mt-1 max-w-sm"},"Enter a query above to search your indexed documents with AI-powered semantic search.")))}var{useState:O,useEffect:Ne,useCallback:G,useRef:we}=React;function ie(t){let[e,a]=O([]),[n,i]=O(!1),[y,C]=O(null),d=G(async(l,u="GENERAL",p=5)=>{if(!t||!l.trim())return a([]),[];i(!0),C(null);try{let S=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/rag/search`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({client_id:t,query:l,phase:u,k:p})});if(!S.ok)throw new Error(`Search failed: ${S.status}`);let N=await S.json();return a(N),N}catch(S){return console.error("RAG Search Error:",S),C(S.message),a([]),[]}finally{i(!1)}},[t]),h=G(()=>{a([]),C(null)},[]);return{results:e,loading:n,error:y,search:d,clear:h}}function ke(t){let[e,a]=O([]),[n,i]=O(null),[y,C]=O(!1),[d,h]=O(null),[l,u]=O({page:1,limit:20,total:0}),p=we(t),S=we(null),N=window.RAG_CONFIG?.serviceUrl||"";Ne(()=>{p.current=t},[t]);let o=G(async(b,w=1,M=20,v)=>{if(!b)return null;let g=await fetch(`${N}/api/documents/${b}?page=${w}&limit=${M}`,{signal:v,credentials:"include"});if(!g.ok)throw new Error(`Failed to fetch documents: ${g.status}`);return g.json()},[N]),m=G(async(b,w)=>{if(!b)return null;let M=await fetch(`${N}/api/stats/${b}`,{signal:w,credentials:"include"});return M.ok?M.json():null},[N]),x=G(async(b=1,w=20)=>{let M=p.current;if(M){C(!0),h(null);try{let v=await o(M,b,w);p.current===M&&v&&(a(v.documents||[]),u({page:v.page||b,limit:v.limit||w,total:v.total||0}))}catch(v){v.name!=="AbortError"&&(console.error("Document Fetch Error:",v),p.current===M&&h(v.message))}finally{p.current===M&&C(!1)}}},[o]),_=G(async()=>{let b=p.current;if(b)try{let w=await m(b);p.current===b&&w&&i(w)}catch(w){w.name!=="AbortError"&&console.error("Stats Fetch Error:",w)}},[m]),$=G(async b=>{let w=p.current;if(!w)return!1;try{if(!(await fetch(`${N}/api/documents/${w}/${b}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Delete failed");return await x(l.page,l.limit),await _(),!0}catch(M){return h(M.message),!1}},[N,l,x,_]);Ne(()=>{if(S.current&&S.current.abort(),a([]),i(null),h(null),u({page:1,limit:20,total:0}),!t){C(!1);return}let b=new AbortController;return S.current=b,(async()=>{C(!0),h(null);try{let[M,v]=await Promise.all([o(t,1,20,b.signal),m(t,b.signal)]);b.signal.aborted||(M&&(a(M.documents||[]),u({page:M.page||1,limit:M.limit||20,total:M.total||0})),v&&i(v))}catch(M){M.name!=="AbortError"&&!b.signal.aborted&&(console.error("Client Data Load Error:",M),h(M.message))}finally{b.signal.aborted||C(!1)}})(),()=>{b.abort()}},[t,o,m]);let T=G(()=>{x(l.page,l.limit),_()},[x,_,l]),s=G(()=>{h(null),x(1,20),_()},[x,_]);return{documents:e,stats:n,loading:y,error:d,pagination:l,fetchDocuments:x,fetchStats:_,deleteDocument:$,refresh:T,retry:s}}function Ce(t){let[e,a]=O(!1),[n,i]=O(0),[y,C]=O(null),[d,h]=O([]),l=window.RAG_CONFIG?.serviceUrl||"",u=G(async(o,m={})=>{if(!t||o.length===0)return[];a(!0),i(0),C(null),h([]);let x=[],_=o.length;for(let $=0;$<o.length;$++){let T=o[$],s=new FormData;s.append("file",T),m.title&&s.append("title",m.title||T.name),m.source_type&&!m.auto_categorize&&s.append("source_type",m.source_type),m.tags&&s.append("tags",m.tags),s.append("auto_categorize",m.auto_categorize!==!1?"true":"false");try{let b=await fetch(`${l}/api/documents/${t}/upload`,{method:"POST",body:s,credentials:"include"}),w=await b.json();x.push({file:T.name,success:b.ok,data:w,error:b.ok?null:w.detail,categorization:w.categorization||null})}catch(b){x.push({file:T.name,success:!1,error:b.message})}i(Math.round(($+1)/_*100))}return h(x),a(!1),x},[t,l]),p=G(async(o,m={})=>{if(!t||!o.trim())return null;a(!0),C(null);try{let x=new FormData;x.append("content",o),x.append("title",m.title||"Text Document"),m.source_type&&!m.auto_categorize&&x.append("source_type",m.source_type),x.append("tags",m.tags||""),x.append("auto_categorize",m.auto_categorize!==!1?"true":"false");let _=await fetch(`${l}/api/documents/${t}/text`,{method:"POST",body:x,credentials:"include"}),$=await _.json();return a(!1),_.ok?$:(C($.detail||"Upload failed"),null)}catch(x){return C(x.message),a(!1),null}},[t,l]),S=G(async(o,m={})=>(C("URL upload not available in standalone mode"),null),[t,l]),N=G(()=>{i(0),C(null),h([])},[]);return{uploading:e,progress:n,error:y,results:d,uploadFiles:u,uploadText:p,uploadUrl:S,reset:N}}function _e(){let[t,e]=O([]),a=G((h,l="info",u=5e3)=>{let p=Date.now();return e(S=>[...S,{id:p,message:h,type:l,duration:u}]),u>0&&setTimeout(()=>{e(S=>S.filter(N=>N.id!==p))},u),p},[]),n=G(h=>{e(l=>l.filter(u=>u.id!==h))},[]),i=G((h,l)=>a(h,"success",l),[a]),y=G((h,l)=>a(h,"error",l),[a]),C=G((h,l)=>a(h,"warning",l),[a]),d=G((h,l)=>a(h,"info",l),[a]);return{toasts:t,addToast:a,removeToast:n,success:i,error:y,warning:C,info:d}}var{useState:ht,useEffect:yt,useCallback:Nt}=React;var{useState:Ie,useEffect:Ge}=React;function Se({clientId:t}){let[e,a]=Ie(null);return Ge(()=>{(()=>{window.Clerk?.user?a({name:window.Clerk.user.fullName,email:window.Clerk.user.primaryEmailAddress?.emailAddress,image:window.Clerk.user.imageUrl}):a({name:"Guest User",email:"guest@emailpilot.ai",image:null})})()},[]),React.createElement("div",{className:"space-y-6 max-w-4xl mx-auto"},React.createElement("div",{className:"flex items-center gap-4 mb-8"},React.createElement("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden border-2 border-background shadow-sm"},e?.image?React.createElement("img",{src:e.image,alt:e.name,className:"h-full w-full object-cover"}):React.createElement(r,{name:"user",className:"h-8 w-8 text-primary"})),React.createElement("div",null,React.createElement("h2",{className:"text-2xl font-bold"},e?.name),React.createElement("p",{className:"text-muted-foreground"},e?.email))),React.createElement("div",null,React.createElement("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2"},React.createElement(r,{name:"grid",className:"h-5 w-5"}),"Integrations"),React.createElement("div",{className:"grid grid-cols-1 gap-6"},React.createElement(se,{className:"opacity-75"},React.createElement(me,null,React.createElement("div",{className:"flex items-start justify-between"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg text-blue-600 dark:text-blue-400"},React.createElement(r,{name:"file-text",className:"h-6 w-6"})),React.createElement("div",null,React.createElement(ue,{className:"text-lg"},"Google Docs Import"),React.createElement(ge,{className:"mt-1"},"Import documents directly from Google Drive"))),React.createElement(re,{variant:"success"},"Active"))),React.createElement(ne,null,React.createElement("p",{className:"text-sm text-muted-foreground"},'This integration is active. You can import documents via the "Upload" tab.'))))))}var{useState:H,useCallback:$e}=React,Pe=window.RAG_CONFIG?.orchestratorUrl||"",Oe=window.RAG_CONFIG?.serviceUrl||"";function Ue(){return Pe||Oe}async function Me(t,e){let a=await fetch(`${Ue()}${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await a.json();if(!a.ok)throw new Error(n?.error?.message||n?.detail||`HTTP ${a.status}`);return n}function Ae({score:t}){let e=Math.round(t*100),a="bg-red-500";return e>=70?a="bg-green-500":e>=50?a="bg-yellow-500":e>=30&&(a="bg-orange-500"),React.createElement("div",{className:"flex items-center gap-2 min-w-[120px]"},React.createElement("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden"},React.createElement("div",{className:`h-full ${a} rounded-full transition-all`,style:{width:`${e}%`}})),React.createElement("span",{className:"text-xs font-mono w-10 text-right"},e,"%"))}function De({clientId:t,toast:e}){let[a,n]=H(""),[i,y]=H(.3),[C,d]=H(10),[h,l]=H(!1),[u,p]=H(null),[S,N]=H(null),[o,m]=H(new Set),[x,_]=H(!1),[$,T]=H(null),s=$e(async()=>{if(!t){e.error("Select a client first");return}let v=a.split(`
`).map(g=>g.trim()).filter(Boolean);if(v.length===0){e.error("Enter at least one test query");return}l(!0),N(null),p(null),m(new Set),T(null);try{let g=await Me("/api/rag/enhanced/audit",{client_id:t,queries:v,top_k:C,min_score:i}),D=g.data||g;p(D),D.low_relevance_docs?.length&&m(new Set(D.low_relevance_docs)),e.success(`Audit complete: ${D.summary?.total_docs||0} docs scored, ${D.summary?.low_relevance_count||0} flagged`)}catch(g){N(g.message),e.error(`Audit failed: ${g.message}`)}finally{l(!1)}},[t,a,C,i,e]),b=v=>{m(g=>{let D=new Set(g);return D.has(v)?D.delete(v):D.add(v),D})},w=()=>{if(!u?.documents)return;let v=u.documents.map(g=>g.doc_id);o.size===v.length?m(new Set):m(new Set(v))},M=$e(async()=>{if(!(!t||o.size===0||!window.confirm(`Delete ${o.size} document${o.size>1?"s":""} and rebuild the vector index?

This cannot be undone.`))){_(!0),T(null);try{let g=await Me("/api/rag/enhanced/prune",{client_id:t,doc_ids:Array.from(o),rebuild_index:!0}),D=g.data||g;if(T(D),u){let E=new Set(D.deleted||[]);p(f=>({...f,documents:f.documents.filter(F=>!E.has(F.doc_id)),low_relevance_docs:f.low_relevance_docs.filter(F=>!E.has(F))})),m(new Set)}e.success(`Pruned ${D.deleted_count||0} docs. Index rebuilt: ${D.vector_index_rebuilt?"yes":"no"}`)}catch(g){e.error(`Prune failed: ${g.message}`)}finally{_(!1)}}},[t,o,u,e]);return t?React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-lg font-semibold flex items-center gap-2"},React.createElement(r,{name:"activity",className:"h-5 w-5 text-blue-600"}),"Relevance Audit"),React.createElement("p",{className:"text-sm text-gray-500"},"Enter test queries (one per line) to score every document by relevance. Documents that never match above the threshold are flagged for pruning."),React.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4"},React.createElement("div",{className:"lg:col-span-2"},React.createElement("label",{className:"block text-sm font-medium mb-1"},"Test Queries"),React.createElement("textarea",{className:"w-full h-28 px-3 py-2 text-sm rounded-md border border-input bg-background focus:outline-none focus:ring-2 focus:ring-ring resize-none",placeholder:`What is the brand voice?
What products do they sell?
Who is the target audience?`,value:a,onChange:v=>n(v.target.value)})),React.createElement("div",{className:"space-y-3"},React.createElement("div",null,React.createElement("label",{className:"block text-sm font-medium mb-1"},"Min Score Threshold"),React.createElement(J,{type:"number",min:"0",max:"1",step:"0.05",value:i,onChange:v=>y(parseFloat(v.target.value)||0)}),React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"0-1 range (0.3 = lenient)")),React.createElement("div",null,React.createElement("label",{className:"block text-sm font-medium mb-1"},"Top K per query"),React.createElement(J,{type:"number",min:"1",max:"50",value:C,onChange:v=>d(parseInt(v.target.value)||10)})))),React.createElement("div",{className:"flex items-center gap-3"},React.createElement(B,{onClick:s,disabled:h},h?React.createElement(React.Fragment,null,React.createElement("svg",{className:"animate-spin h-4 w-4 mr-2",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),"Running Audit..."):React.createElement(React.Fragment,null,React.createElement(r,{name:"search",className:"h-4 w-4 mr-2"}),"Run Audit")),o.size>0&&React.createElement(B,{variant:"destructive",onClick:M,disabled:x},x?React.createElement(React.Fragment,null,React.createElement("svg",{className:"animate-spin h-4 w-4 mr-2",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),"Pruning..."):React.createElement(React.Fragment,null,React.createElement(r,{name:"trash-2",className:"h-4 w-4 mr-2"}),"Prune ",o.size," doc",o.size>1?"s":"")))),S&&React.createElement(q,{variant:"destructive"},React.createElement(Q,null,"Audit Failed"),React.createElement(K,null,S)),$&&React.createElement(q,null,React.createElement(Q,null,"Prune Complete"),React.createElement(K,null,"Deleted ",$.deleted_count||0," documents. Docs before: ",$.before_stats?.document_count,", after: ",$.after_stats?.document_count,".",$.vector_index_rebuilt&&" Vector index rebuilt.",$.failed?.length>0&&` ${$.failed.length} failed.`,$.invalid_ids?.length>0&&` ${$.invalid_ids.length} not found.`)),u&&React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},React.createElement("div",{className:"p-4 rounded-lg border border-gray-100 bg-white"},React.createElement("div",{className:"text-2xl font-bold"},u.summary?.total_docs||0),React.createElement("div",{className:"text-xs text-gray-500 mt-1"},"Total Documents")),React.createElement("div",{className:"p-4 rounded-lg border border-gray-100 bg-white"},React.createElement("div",{className:"text-2xl font-bold"},u.summary?.docs_scored||0),React.createElement("div",{className:"text-xs text-gray-500 mt-1"},"Docs Matched")),React.createElement("div",{className:"p-4 rounded-lg border border-gray-100 bg-white"},React.createElement("div",{className:"text-2xl font-bold"},u.summary?.queries_run||0),React.createElement("div",{className:"text-xs text-gray-500 mt-1"},"Queries Run")),React.createElement("div",{className:"p-4 rounded-lg border border-orange-200 bg-orange-50"},React.createElement("div",{className:"text-2xl font-bold text-orange-700"},u.summary?.low_relevance_count||0),React.createElement("div",{className:"text-xs text-orange-600 mt-1"},"Low Relevance"))),React.createElement("div",{className:"border rounded-lg overflow-hidden"},React.createElement("table",{className:"w-full text-sm"},React.createElement("thead",null,React.createElement("tr",{className:"bg-gray-50 border-b"},React.createElement("th",{className:"w-10 px-3 py-3 text-left"},React.createElement("input",{type:"checkbox",className:"rounded border-gray-300",checked:u.documents?.length>0&&o.size===u.documents.length,onChange:w})),React.createElement("th",{className:"px-3 py-3 text-left font-medium text-gray-600"},"Document"),React.createElement("th",{className:"px-3 py-3 text-left font-medium text-gray-600 w-20"},"Chunks"),React.createElement("th",{className:"px-3 py-3 text-left font-medium text-gray-600 w-20"},"Matched"),React.createElement("th",{className:"px-3 py-3 text-left font-medium text-gray-600 w-36"},"Avg Score"),React.createElement("th",{className:"px-3 py-3 text-left font-medium text-gray-600 w-36"},"Best Score"),React.createElement("th",{className:"px-3 py-3 text-left font-medium text-gray-600 w-24"},"Status"))),React.createElement("tbody",null,(u.documents||[]).map(v=>{let g=u.low_relevance_docs?.includes(v.doc_id);return React.createElement("tr",{key:v.doc_id,className:`border-b last:border-0 hover:bg-gray-50 transition-colors ${g?"bg-orange-50/50":""}`},React.createElement("td",{className:"px-3 py-3"},React.createElement("input",{type:"checkbox",className:"rounded border-gray-300",checked:o.has(v.doc_id),onChange:()=>b(v.doc_id)})),React.createElement("td",{className:"px-3 py-3"},React.createElement("div",{className:"font-medium text-gray-900 truncate max-w-[300px]"},v.title||v.doc_id),React.createElement("div",{className:"text-xs text-gray-400 font-mono truncate"},v.doc_id)),React.createElement("td",{className:"px-3 py-3 text-gray-600"},v.chunk_count||0),React.createElement("td",{className:"px-3 py-3 text-gray-600"},v.queries_matched||0),React.createElement("td",{className:"px-3 py-3"},React.createElement(Ae,{score:v.avg_score||0})),React.createElement("td",{className:"px-3 py-3"},React.createElement(Ae,{score:v.max_score||0})),React.createElement("td",{className:"px-3 py-3"},g?React.createElement("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700"},React.createElement(r,{name:"alert-triangle",className:"h-3 w-3"}),"Low"):v.queries_matched>0?React.createElement("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700"},React.createElement(r,{name:"check",className:"h-3 w-3"}),"Good"):React.createElement("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-500"},"No hits")))}))),u.documents?.length===0&&React.createElement("div",{className:"p-8 text-center text-gray-500"},"No documents found for this client.")))):React.createElement(X,{icon:"user-x",title:"No Client Selected",description:"Select a client from the dropdown above to audit and manage RAG documents."})}var{useState:j,useEffect:ae,useCallback:W}=React;function Be(){return typeof EmailPilotAuth<"u"?EmailPilotAuth.ready():new Promise(t=>{let e=()=>{typeof EmailPilotAuth<"u"?EmailPilotAuth.ready().then(t):setTimeout(e,100)};e()})}window.RAG_CONFIG=window.RAG_CONFIG||{serviceUrl:window.location.origin,orchestratorUrl:""};var Ve=[{value:"brand_voice",label:"Brand Voice"},{value:"brand_guidelines",label:"Brand Guidelines"},{value:"content_pillars",label:"Content Pillars"},{value:"marketing_strategy",label:"Marketing Strategy"},{value:"product",label:"Product Catalog"},{value:"target_audience",label:"Target Audience"},{value:"past_campaign",label:"Campaign History"},{value:"seasonal_themes",label:"Seasonal Themes"},{value:"general",label:"General"}];function He({value:t,onChange:e,clients:a,loading:n,onRefresh:i}){let[y,C]=j(!1),d=a.find(l=>l.client_id===t);ae(()=>{let l=u=>{u.target.closest(".client-selector-dropdown")||C(!1)};return document.addEventListener("click",l),()=>document.removeEventListener("click",l)},[]);let h=l=>{switch(l?.toUpperCase()){case"LIVE":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"ONBOARDING":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"INACTIVE":return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}};return React.createElement("div",{className:"relative client-selector-dropdown"},React.createElement("button",{onClick:l=>{l.stopPropagation(),C(!y)},disabled:n,className:"w-full h-10 pl-3 pr-10 rounded-md border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-ring flex items-center gap-2 text-left"},React.createElement(r,{name:n?"refresh-cw":"building-2",className:`h-4 w-4 text-muted-foreground flex-shrink-0 ${n?"animate-spin":""}`}),n?React.createElement("span",{className:"text-muted-foreground"},"Loading clients..."):d?React.createElement("div",{className:"flex items-center gap-2 min-w-0 flex-1"},React.createElement("span",{className:"truncate"},d.name),d.status&&React.createElement("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${h(d.status)}`},d.status)):React.createElement("span",{className:"text-muted-foreground"},"Select a client..."),React.createElement(r,{name:"chevron-down",className:`absolute right-3 h-4 w-4 text-muted-foreground transition-transform ${y?"rotate-180":""}`})),y&&React.createElement("div",{className:"absolute z-50 mt-1 w-full min-w-[320px] max-h-[400px] overflow-auto rounded-md border border-input bg-background shadow-lg"},React.createElement("div",{className:"p-2 border-b border-input bg-muted/50"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs font-medium text-muted-foreground"},a.length," Live Client",a.length!==1?"s":""),React.createElement("button",{onClick:l=>{l.stopPropagation(),i()},disabled:n,className:"p-1 hover:bg-accent rounded",title:"Refresh clients"},React.createElement(r,{name:"refresh-cw",className:`h-3 w-3 ${n?"animate-spin":""}`})))),React.createElement("div",{className:"py-1"},a.length===0?React.createElement("div",{className:"px-3 py-4 text-center text-sm text-muted-foreground"},n?"Loading clients...":"No clients available"):a.map(l=>React.createElement("button",{key:l.client_id,onClick:u=>{u.stopPropagation(),e(l.client_id),C(!1)},className:`w-full px-3 py-2 text-left hover:bg-accent flex items-start gap-3 ${t===l.client_id?"bg-accent":""}`},React.createElement("div",{className:"flex-shrink-0 mt-0.5"},React.createElement("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center"},React.createElement("span",{className:"text-xs font-semibold text-primary"},(l.name||l.client_id).substring(0,2).toUpperCase()))),React.createElement("div",{className:"flex-1 min-w-0"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"font-medium text-sm truncate"},l.name||l.client_id),l.status&&React.createElement("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded flex-shrink-0 ${h(l.status)}`},l.status)),React.createElement("div",{className:"flex items-center gap-2 mt-0.5"},l.industry&&React.createElement("span",{className:"text-xs text-muted-foreground"},l.industry),l.document_count>0&&React.createElement("span",{className:"text-xs text-muted-foreground"},"\u2022 ",l.document_count," doc",l.document_count!==1?"s":""))),t===l.client_id&&React.createElement(r,{name:"check",className:"h-4 w-4 text-primary flex-shrink-0 mt-1"}))))))}function qe(){let[t,e]=j("intelligence"),[a,n]=j("browse"),[i,y]=j(""),[C,d]=j([]),[h,l]=j(!1),[u,p]=j({title:"",source_type:"general",tags:"",auto_categorize:!0}),[S,N]=j(null),[o,m]=j(null),[x,_]=j(null),[$,T]=j(!1),s=_e(),b=ie(i),w=ke(i),M=Ce(i),v=W(async()=>{l(!0);try{let k=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/clients`);if(k.ok){let z=await k.json();d(z.clients||[])}else console.error("Failed to fetch clients:",k.status)}catch(k){console.error("Failed to fetch clients:",k)}finally{l(!1)}},[]),g=W(k=>{y(k);let z=C.find(c=>c.client_id===k);z&&s.success(`Switched to ${z.name}`)},[C,s]);ae(()=>{let k=!1;return(async()=>{await Be(),k||v()})(),()=>{k=!0}},[v]);let D=W(async k=>{if(!i){s.error("Please select a client first");return}N(null);let z=await M.uploadFiles(k,u),c=z.filter(R=>R.success).length,A=z.filter(R=>!R.success).length;if(c>0){let R=z.filter(I=>I.categorization?.method==="llm");if(R.length>0){let I=R[0].categorization;N(I),s.success(`${c} file(s) uploaded! AI categorized as: ${I.category}`)}else s.success(`${c} file(s) uploaded successfully`)}A>0&&s.error(`${A} file(s) failed to upload`),w.refresh()},[i,u,M,s,w]),E=W(async k=>{if(!i){s.error("Please select a client first");return}N(null);let z=await M.uploadText(k,u);z?(z.categorization?.method==="llm"?(N(z.categorization),s.success(`Text uploaded! AI categorized as: ${z.categorization.category}`)):s.success("Text content uploaded successfully"),w.refresh()):s.error(M.error||"Failed to upload text")},[i,u,M,s,w]),f=W(async k=>{m(k),_(null),T(!0);try{let z=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/documents/${i}/${k.id}`);if(z.ok){let c=await z.json();_(c)}else{let c=await z.json();s.error(c.detail||"Failed to load document"),m(null)}}catch(z){console.error("Failed to fetch document:",z),s.error("Failed to load document content"),m(null)}finally{T(!1)}},[i,s]),F=W(()=>{m(null),_(null)},[]),P=W(async(k,z)=>{s.info(`Exporting ${k.title} as ${z}...`)},[s]),L=W((k,z,c)=>{b.search(k,z,c)},[b]);return React.createElement("div",{className:"bg-background"},React.createElement("div",{className:"bg-white border-b border-gray-200 px-6 py-4"},React.createElement("div",{className:"max-w-6xl mx-auto flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-4"},React.createElement("div",{className:"w-72"},React.createElement(He,{value:i,onChange:g,clients:C,loading:h,onRefresh:v})),React.createElement("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-green-50 text-green-700 text-sm border border-green-200"},React.createElement("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),React.createElement("span",{className:"font-medium"},"Connected"))),React.createElement("button",{onClick:()=>e("user"),className:`p-2 rounded-md transition-colors ${t==="user"?"bg-blue-50 text-blue-600":"hover:bg-gray-100 text-gray-600"}`,title:"User Manager & Settings"},React.createElement(r,{name:"settings",className:"h-5 w-5"})))),React.createElement("main",{className:"p-8"},React.createElement("div",{className:"max-w-6xl mx-auto"},i&&w.stats&&React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},React.createElement("div",{className:"ep-card ep-shadow-none bg-white p-6 rounded-xl border border-gray-100"},React.createElement("div",{className:"flex items-center justify-between mb-2"},React.createElement("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider"},"Documents"),React.createElement("div",{className:"p-2 bg-blue-50 rounded-lg"},React.createElement(r,{name:"file-text",className:"h-5 w-5 text-blue-600"}))),React.createElement("div",{className:"text-3xl font-black text-gray-900"},w.stats.document_count||0),React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"Total documents indexed")),React.createElement("div",{className:"ep-card ep-shadow-none bg-white p-6 rounded-xl border border-gray-100"},React.createElement("div",{className:"flex items-center justify-between mb-2"},React.createElement("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider"},"Characters"),React.createElement("div",{className:"p-2 bg-purple-50 rounded-lg"},React.createElement(r,{name:"text",className:"h-5 w-5 text-purple-600"}))),React.createElement("div",{className:"text-3xl font-black text-gray-900"},((w.stats.total_characters||0)/1e3).toFixed(1),"k"),React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"Total content size")),React.createElement("div",{className:"ep-card ep-shadow-none bg-white p-6 rounded-xl border border-gray-100"},React.createElement("div",{className:"flex items-center justify-between mb-2"},React.createElement("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider"},"Vector Status"),React.createElement("div",{className:`p-2 rounded-lg ${w.stats.vector_enabled?"bg-green-50":"bg-gray-50"}`},React.createElement(r,{name:"database",className:`h-5 w-5 ${w.stats.vector_enabled?"text-green-600":"text-gray-400"}`}))),React.createElement("div",{className:"text-3xl font-black text-gray-900"},w.stats.vector_enabled?"Active":"Inactive"),React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"Semantic search ",w.stats.vector_enabled?"enabled":"disabled"))),React.createElement("div",{className:"bg-white rounded-xl border border-gray-100 p-6"},React.createElement(pe,{value:t,onValueChange:e},React.createElement(fe,{className:"mb-6"},React.createElement(Z,{value:"intelligence"},React.createElement(r,{name:"sparkles",className:"h-4 w-4 mr-2"}),"Intelligence"),React.createElement(Z,{value:"library"},React.createElement(r,{name:"library",className:"h-4 w-4 mr-2"}),"Library"),React.createElement(Z,{value:"manage"},React.createElement(r,{name:"activity",className:"h-4 w-4 mr-2"}),"Manage"),React.createElement(Z,{value:"user"},React.createElement(r,{name:"settings",className:"h-4 w-4 mr-2"}),"Settings")),React.createElement(ee,{value:"intelligence"},i?React.createElement("div",{className:"flex flex-col lg:flex-row gap-6"},React.createElement("div",{className:"flex-1 min-w-0 space-y-6"},React.createElement("h3",{className:"text-lg font-semibold flex items-center gap-2"},React.createElement(r,{name:"upload-cloud",className:"h-5 w-5 text-blue-600"}),"Upload Knowledge"),React.createElement("div",{className:`rounded-lg p-4 border ${u.auto_categorize?"bg-primary/5 border-primary/20":"bg-muted border-muted"}`},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("div",{className:`rounded-full p-2 ${u.auto_categorize?"bg-primary/10":"bg-muted"}`},React.createElement(r,{name:"sparkles",className:`h-5 w-5 ${u.auto_categorize?"text-primary":"text-muted-foreground"}`})),React.createElement("div",null,React.createElement("h4",{className:"text-sm font-medium"},"AI Auto-Categorization"),React.createElement("p",{className:"text-xs text-muted-foreground"},u.auto_categorize?"Claude will analyze content and assign the best category + keywords":"Using manual category selection"))),React.createElement("button",{onClick:()=>p(k=>({...k,auto_categorize:!k.auto_categorize})),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${u.auto_categorize?"bg-primary":"bg-muted"}`},React.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${u.auto_categorize?"translate-x-6":"translate-x-1"}`})))),S&&React.createElement("div",{className:"rounded-lg p-4 bg-success/10 border border-success/20"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement(r,{name:"check-circle",className:"h-5 w-5 text-success mt-0.5"}),React.createElement("div",{className:"flex-1"},React.createElement("h4",{className:"text-sm font-medium text-success"},"AI Categorization Result"),React.createElement("div",{className:"mt-2 space-y-1"},React.createElement("p",{className:"text-sm"},React.createElement("span",{className:"text-muted-foreground"},"Category:")," ",React.createElement("span",{className:"font-medium capitalize"},S.category?.replace(/_/g," "))),React.createElement("p",{className:"text-sm"},React.createElement("span",{className:"text-muted-foreground"},"Confidence:")," ",React.createElement("span",{className:"font-medium"},Math.round((S.confidence||0)*100),"%")),S.keywords?.length>0&&React.createElement("div",{className:"mt-2"},React.createElement("span",{className:"text-xs text-muted-foreground"},"Keywords:"),React.createElement("div",{className:"flex flex-wrap gap-1 mt-1"},S.keywords.map((k,z)=>React.createElement("span",{key:z,className:"text-xs px-2 py-0.5 bg-muted rounded-full"},k)))))),React.createElement("button",{onClick:()=>N(null),className:"p-1 hover:bg-muted rounded"},React.createElement(r,{name:"x",className:"h-4 w-4 text-muted-foreground"})))),React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},React.createElement("div",null,React.createElement("label",{className:"block text-sm font-medium mb-2"},"Document Title"),React.createElement(J,{value:u.title,onChange:k=>p(z=>({...z,title:k.target.value})),placeholder:"Enter title..."})),React.createElement("div",null,React.createElement("label",{className:"block text-sm font-medium mb-2"},"Source Type",u.auto_categorize&&React.createElement("span",{className:"ml-2 text-xs text-primary font-normal"},"(AI will override)")),React.createElement(de,{value:u.source_type,onChange:k=>p(z=>({...z,source_type:k.target.value})),disabled:u.auto_categorize,className:u.auto_categorize?"opacity-50":""},Ve.map(k=>React.createElement("option",{key:k.value,value:k.value},k.label)))),React.createElement("div",null,React.createElement("label",{className:"block text-sm font-medium mb-2"},"Tags"),React.createElement(J,{value:u.tags,onChange:k=>p(z=>({...z,tags:k.target.value})),placeholder:u.auto_categorize?"AI will generate keywords":"tag1, tag2, tag3"}))),React.createElement(be,{onFilesSelected:k=>console.log("Selected:",k.length),onUpload:D,uploading:M.uploading,progress:M.progress,maxFiles:10}),React.createElement("div",{className:"border-t pt-6"},React.createElement("h4",{className:"text-sm font-medium mb-3"},"Or paste text content directly"),React.createElement(Xe,{onUpload:E,uploading:M.uploading}))),React.createElement("div",{className:"lg:w-[420px] flex-shrink-0"},React.createElement(Qe,{clientId:i,toast:s,compact:!0}))):React.createElement(X,{icon:"user-x",title:"No Client Selected",description:"Please select a client from the dropdown above to start uploading documents and view your intelligence grade."})),React.createElement(ee,{value:"library"},i?React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"flex items-center gap-1 p-1 bg-gray-100 rounded-lg w-fit"},React.createElement("button",{onClick:()=>n("browse"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${a==="browse"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`},React.createElement(r,{name:"library",className:"h-4 w-4"}),"Browse"),React.createElement("button",{onClick:()=>n("search"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${a==="search"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`},React.createElement(r,{name:"sparkles",className:"h-4 w-4"}),"Semantic Search")),a==="browse"?React.createElement(he,{documents:w.documents,loading:w.loading,error:w.error,pagination:w.pagination,onPageChange:k=>w.fetchDocuments(k),onDelete:w.deleteDocument,onView:f,onExport:P,onRefresh:w.refresh,onRetry:w.retry,onSwitchToUpload:()=>e("intelligence")}):React.createElement(ye,{clientId:i,results:b.results,loading:b.loading,error:b.error,onSearch:L})):React.createElement(X,{icon:"user-x",title:"No Client Selected",description:"Please select a client from the dropdown above to browse documents."})),React.createElement(ee,{value:"manage"},React.createElement(De,{clientId:i,toast:s})),React.createElement(ee,{value:"user"},React.createElement(Se,{clientId:i})))))),React.createElement(xe,{toasts:s.toasts,onRemove:s.removeToast}),o&&React.createElement("div",{className:"fixed inset-0 z-50"},React.createElement("div",{className:"fixed inset-0 bg-black/80",onClick:F}),React.createElement("div",{className:"fixed inset-0 flex items-center justify-center p-4"},React.createElement("div",{className:"bg-background rounded-lg shadow-lg max-w-4xl w-full max-h-[90vh] flex flex-col animate-fade-in"},React.createElement("div",{className:"flex items-center justify-between p-4 border-b"},React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement("div",{className:"rounded-lg bg-muted p-2"},React.createElement(r,{name:"file-text",className:"h-5 w-5 text-muted-foreground"})),React.createElement("div",{className:"min-w-0"},React.createElement("h3",{className:"text-lg font-semibold truncate"},o.title||"Untitled Document"),React.createElement("div",{className:"flex items-center gap-2 text-sm text-muted-foreground"},React.createElement("span",{className:"capitalize"},o.source_type?.replace(/_/g," ")||"general"),x?.size&&React.createElement(React.Fragment,null,React.createElement("span",null,"\u2022"),React.createElement("span",null,x.size.toLocaleString()," characters"))))),React.createElement("button",{onClick:F,className:"p-2 rounded-md hover:bg-muted"},React.createElement(r,{name:"x",className:"h-5 w-5"}))),React.createElement("div",{className:"flex-1 overflow-auto p-4"},$?React.createElement("div",{className:"flex items-center justify-center py-12"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("svg",{className:"animate-spin h-5 w-5 text-primary",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),React.createElement("span",{className:"text-muted-foreground"},"Loading document content..."))):x?.content?React.createElement("div",{className:"bg-muted/30 rounded-lg p-4"},React.createElement("pre",{className:"whitespace-pre-wrap text-sm font-mono leading-relaxed"},x.content)):React.createElement("div",{className:"flex items-center justify-center py-12 text-muted-foreground"},"No content available")),React.createElement("div",{className:"flex items-center justify-between p-4 border-t bg-muted/30"},React.createElement("div",{className:"text-xs text-muted-foreground"},x?.source&&React.createElement("span",null,"Source: ",x.source)),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{onClick:()=>{x?.content&&(navigator.clipboard.writeText(x.content),s.success("Content copied to clipboard"))},disabled:!x?.content,className:"h-9 px-4 rounded-md border border-input bg-background hover:bg-accent text-sm font-medium disabled:opacity-50"},"Copy Content"),React.createElement("button",{onClick:F,className:"h-9 px-4 rounded-md bg-primary text-primary-foreground hover:bg-primary/90 text-sm font-medium"},"Close")))))))}function Qe({clientId:t,toast:e,compact:a=!1}){let[n,i]=j(!1),[y,C]=j(!1),[d,h]=j(null),[l,u]=j(null),[p,S]=j(null),[N,o]=j({}),[m,x]=j(null),[_,$]=j({}),[T,s]=j(new Set),[b,w]=j(!1),[M,v]=j(null);ae(()=>{(async()=>{try{let A=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/intelligence/requirements`);if(A.ok){let R=await A.json();S(R)}}catch(A){console.error("Failed to fetch requirements:",A)}})()},[]),ae(()=>{if(!t){h(null),v(null);return}let c=!1;return(async()=>{try{let R=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/intelligence/last-grade/${t}`);if(R.ok&&!c){let I=await R.json();h(I),v(I.saved_at||I.graded_at||null)}}catch(R){console.debug("No cached grade:",R)}})(),()=>{c=!0}},[t]);let g=c=>{o(A=>({...A,[c]:!A[c]}))},D=async()=>{if(!t){e.error("Please select a client first");return}i(!0),u(null);try{let c=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/intelligence/grade/${t}`);if(!c.ok){let R=await c.json();throw new Error(R.detail||"Failed to grade intelligence")}let A=await c.json();h(A),v(new Date().toISOString()),e.success(`Intelligence Grade: ${A.overall_grade} (${A.overall_score}%)`)}catch(c){console.error("Intelligence grading failed:",c),u(c.message),e.error(c.message||"Failed to analyze intelligence")}finally{i(!1)}},E=async()=>{if(!t){e.error("Please select a client first");return}C(!0),u(null);try{let c=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/intelligence/quick-assessment/${t}`);if(!c.ok){let R=await c.json();throw new Error(R.detail||"Failed to assess intelligence")}let A=await c.json();h({...A,overall_grade:A.estimated_grade,overall_score:A.estimated_score,is_quick_assessment:!0}),e.info(`Quick Assessment: ${A.estimated_grade} (${A.estimated_score}%)`)}catch(c){console.error("Quick assessment failed:",c),u(c.message),e.error(c.message||"Failed to assess intelligence")}finally{C(!1)}},f=async(c,A,R=null)=>{if(!(!A?.trim()&&!R)){x(c);try{let I;if(R){let U=new FormData;U.append("file",R),U.append("client_id",t),U.append("title",`${c} - ${R.name}`),U.append("source_type","quick_capture"),U.append("auto_categorize","true"),U.append("field_name",c),I=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/documents/${t}/upload`,{method:"POST",body:U,credentials:"include"})}else I=await fetch(`${window.RAG_CONFIG?.serviceUrl||""}/api/intelligence/quick-capture`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,answers:[{field_name:c,content:A.trim()}],auto_categorize:!0})});if(I.ok){let U=await I.json(),Te=U.categorization?` (categorized as ${U.categorization.category})`:"";e.success(`\u2713 Saved${Te}! Click "Re-analyze" to see your updated score.`),s(Y=>new Set([...Y,c])),$(Y=>({...Y,[c]:""})),o(Y=>({...Y,[c]:!1,[`gap-${c}`]:!1,[`quick-${c}`]:!1})),w(!0)}else{let U=await I.json();throw new Error(U.detail||"Failed to save")}}catch(I){e.error(I.message||"Failed to save information")}finally{x(null)}}},F=()=>{w(!1),s(new Set),d?.is_quick_assessment?E():D()},P=c=>{switch(c){case"A":return"text-green-600 bg-green-50 border-green-200";case"B":return"text-blue-600 bg-blue-50 border-blue-200";case"C":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"D":return"text-orange-600 bg-orange-50 border-orange-200";case"F":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},L=c=>{switch(c){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},k=c=>Math.max(0,100-c),z=c=>p?.dimensions?.[c]?p.dimensions[c].fields||[]:[];return t?React.createElement("div",{className:"space-y-4"},a?React.createElement("div",{className:"space-y-3"},React.createElement("h3",{className:"text-lg font-semibold flex items-center gap-2"},React.createElement(r,{name:"bar-chart-3",className:"h-5 w-5 text-indigo-600"}),"Intelligence Grade"),M&&React.createElement("p",{className:"text-xs text-muted-foreground"},"Last graded: ",new Date(M).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),React.createElement("div",{className:"flex gap-2"},React.createElement(B,{onClick:D,disabled:n||y,loading:n,size:"sm",className:"gap-1.5 text-xs"},React.createElement(r,{name:"sparkles",className:"h-3.5 w-3.5"}),"Full Analysis"),React.createElement(B,{onClick:E,disabled:n||y,loading:y,variant:"outline",size:"sm",className:"gap-1.5 text-xs"},React.createElement(r,{name:"zap",className:"h-3.5 w-3.5"}),"Quick"))):React.createElement("div",{className:"flex items-center gap-4"},React.createElement(B,{onClick:D,disabled:n||y,loading:n,className:"gap-2"},React.createElement(r,{name:"sparkles",className:"h-4 w-4"}),"Run Full Analysis"),React.createElement(B,{onClick:E,disabled:n||y,loading:y,variant:"outline",className:"gap-2"},React.createElement(r,{name:"zap",className:"h-4 w-4"}),"Quick Assessment"),React.createElement("span",{className:"text-sm text-muted-foreground"},"Full analysis uses AI, quick uses keyword matching")),l&&React.createElement(q,{variant:"destructive"},React.createElement(r,{name:"alert-circle",className:"h-4 w-4"}),React.createElement(Q,null,"Analysis Failed"),React.createElement(K,null,l)),d&&React.createElement("div",{className:"space-y-4"},a?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:`p-4 rounded-xl border-2 ${P(d.overall_grade)} flex items-center gap-4`},React.createElement("div",{className:"text-4xl font-black"},d.overall_grade),React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"text-lg font-bold"},d.overall_score,"%"),React.createElement("div",{className:"text-xs opacity-75"},d.is_quick_assessment?"Estimated":"Full Analysis")),React.createElement("div",{className:`text-sm font-semibold ${d.ready_for_generation?"text-green-600":"text-red-600"}`},d.ready_for_generation?"Ready":"Not Ready")),React.createElement("div",{className:"flex gap-3 text-xs text-gray-500"},React.createElement("span",null,d.documents_analyzed||0," docs"),React.createElement("span",null,d.fields_found||0,"/",d.total_fields||0," fields"))):React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},React.createElement("div",{className:`p-6 rounded-xl border-2 ${P(d.overall_grade)} text-center`},React.createElement("div",{className:"text-6xl font-black"},d.overall_grade),React.createElement("div",{className:"text-lg font-medium mt-1"},d.overall_score,"%"),React.createElement("div",{className:"text-sm opacity-75 mt-1"},d.is_quick_assessment?"Estimated Grade":"Overall Grade")),React.createElement("div",{className:"p-6 rounded-xl border border-gray-200 bg-white"},React.createElement("div",{className:"text-sm text-gray-500 mb-1"},"Documents Analyzed"),React.createElement("div",{className:"text-3xl font-bold"},d.documents_analyzed||0)),React.createElement("div",{className:"p-6 rounded-xl border border-gray-200 bg-white"},React.createElement("div",{className:"text-sm text-gray-500 mb-1"},"Fields Found"),React.createElement("div",{className:"text-3xl font-bold"},d.fields_found||0,React.createElement("span",{className:"text-lg font-normal text-gray-400"},"/",d.total_fields||0))),React.createElement("div",{className:"p-6 rounded-xl border border-gray-200 bg-white"},React.createElement("div",{className:"text-sm text-gray-500 mb-1"},"Ready for Generation"),React.createElement("div",{className:`text-3xl font-bold ${d.ready_for_generation?"text-green-600":"text-red-600"}`},d.ready_for_generation?"Yes":"No"))),b&&React.createElement("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("div",{className:"p-2 bg-white/20 rounded-xl"},React.createElement(r,{name:"refresh-cw",className:"h-5 w-5"})),React.createElement("div",null,React.createElement("h4",{className:"font-semibold"},"New information added!"),React.createElement("p",{className:"text-sm text-blue-100"},"Re-analyze to see your updated Intelligence Grade."))),React.createElement("button",{onClick:F,className:"px-5 py-2.5 bg-white text-blue-600 rounded-xl font-semibold hover:bg-blue-50 transition-all shadow-md hover:shadow-lg"},"Re-analyze Now"))),a&&d.dimension_scores&&React.createElement("div",{className:"space-y-3"},React.createElement("h4",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider"},"Checklist"),Object.entries(d.dimension_scores).map(([c,A])=>React.createElement("div",{key:c,className:"space-y-1"},React.createElement("div",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mt-2"},A.display_name," (",A.grade,")"),A.fields?.map((R,I)=>React.createElement("div",{key:I,className:"flex items-center gap-2 py-1"},R.found?React.createElement(r,{name:"check-circle",className:"h-4 w-4 text-green-500 flex-shrink-0"}):T.has(R.field_name)?React.createElement(r,{name:"clock",className:"h-4 w-4 text-blue-500 flex-shrink-0"}):React.createElement(r,{name:"x-circle",className:"h-4 w-4 text-red-400 flex-shrink-0"}),React.createElement("span",{className:`text-sm ${R.found?"text-gray-700":"text-gray-500"}`},R.display_name),R.found&&R.coverage<80&&React.createElement("span",{className:"text-[10px] text-yellow-600"},"(",Math.round(R.coverage),"%)"))),A.gaps?.filter(R=>!R.found&&!T.has(R.field_name)).map((R,I)=>R.quick_capture_prompt&&React.createElement("div",{key:`hint-${I}`,className:"ml-6 text-xs text-gray-400 italic"},R.quick_capture_prompt))))),!a&&React.createElement(React.Fragment,null,d.overall_grade!=="A"&&!b&&React.createElement("div",{className:"p-5 rounded-2xl border border-emerald-200 bg-gradient-to-br from-emerald-50 via-green-50 to-teal-50"},React.createElement("h3",{className:"text-lg font-bold text-emerald-800 mb-3 flex items-center gap-2"},React.createElement(r,{name:"trending-up",className:"h-5 w-5"}),"Path to A+ (",k(d.overall_score)," points needed)"),React.createElement("p",{className:"text-sm text-emerald-700 mb-4"},"Focus on these high-impact improvements:"),React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},(d.critical_gaps||[]).slice(0,4).map((c,A)=>React.createElement("div",{key:A,className:"flex items-center gap-3 p-3 bg-white/60 rounded-xl border border-emerald-100"},React.createElement("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center text-emerald-600 font-bold text-sm"},A+1),React.createElement("div",{className:"flex-1 min-w-0"},React.createElement("span",{className:"text-sm text-emerald-800 line-clamp-1"},c.action||c.display_name)),React.createElement("span",{className:"text-emerald-600 font-semibold text-sm whitespace-nowrap"},"+",c.expected_improvement,"%")))),React.createElement("p",{className:"text-xs text-emerald-600 mt-4 flex items-center gap-1"},React.createElement(r,{name:"info",className:"h-3 w-3"}),"Expand the cards below to add missing information")),d.is_quick_assessment&&React.createElement(q,null,React.createElement(r,{name:"info",className:"h-4 w-4"}),React.createElement(Q,null,"Quick Assessment - Keyword Matching"),React.createElement(K,null,React.createElement("p",{className:"mb-2"},d.note||"This is a keyword-based estimate. Run Full Analysis for AI-powered detailed grading."),React.createElement("p",{className:"text-xs text-muted-foreground"},React.createElement("strong",null,"How it works:"),' The quick assessment scans your documents for specific keywords related to each field. If no keywords are found, that field is marked as missing. See the "What We Searched For" sections below for details.'))),d.generation_warnings?.length>0&&React.createElement(q,{variant:"warning"},React.createElement(r,{name:"alert-triangle",className:"h-4 w-4"}),React.createElement(Q,null,"Generation Warnings"),React.createElement(K,null,React.createElement("ul",{className:"list-disc list-inside mt-2 space-y-1"},d.generation_warnings.map((c,A)=>React.createElement("li",{key:A},c))))),d.dimension_scores&&Object.keys(d.dimension_scores).length>0&&React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-lg font-semibold"},"Dimension Scores"),React.createElement("div",{className:"space-y-4"},Object.entries(d.dimension_scores).map(([c,A])=>React.createElement(We,{key:c,dimKey:c,dim:A,requirements:p,isExpanded:N[c],onToggle:()=>g(c),getGradeColor:P,getImportanceColor:L,clientId:t,toast:e,quickCaptureText:_,setQuickCaptureText:$,uploadingField:m,onQuickCapture:f,isQuickAssessment:d.is_quick_assessment,completedFields:T})))),d.critical_gaps?.length>0&&React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-lg font-semibold text-red-600 flex items-center gap-2"},React.createElement(r,{name:"alert-triangle",className:"h-5 w-5"}),"Critical Gaps (",d.critical_gaps.filter(c=>!T.has(c.field_name)).length," remaining)"),React.createElement("div",{className:"space-y-3"},d.critical_gaps.map((c,A)=>React.createElement(Je,{key:A,gap:c,index:A,isExpanded:N[`gap-${c.field_name}`],onToggle:()=>g(`gap-${c.field_name}`),getImportanceColor:L,clientId:t,toast:e,quickCaptureText:_,setQuickCaptureText:$,uploadingField:m,onQuickCapture:f,requirements:p,isQuickAssessment:d.is_quick_assessment,isCompleted:T.has(c.field_name)})))),d.dimension_summaries&&React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-lg font-semibold"},"Dimension Coverage"),React.createElement("div",{className:"space-y-4"},Object.entries(d.dimension_summaries).map(([c,A])=>React.createElement(Ke,{key:c,dimKey:c,dim:A,requirements:p,isExpanded:N[`quick-${c}`],onToggle:()=>g(`quick-${c}`),clientId:t,toast:e,quickCaptureText:_,setQuickCaptureText:$,uploadingField:m,onQuickCapture:f,completedFields:T})))))),!d&&!n&&!y&&!l&&React.createElement("div",{className:`text-center border-2 border-dashed border-gray-200 rounded-xl ${a?"py-8":"py-12"}`},React.createElement(r,{name:"bar-chart-3",className:`mx-auto text-gray-400 mb-4 ${a?"h-8 w-8":"h-12 w-12"}`}),React.createElement("h3",{className:`font-medium text-gray-900 mb-2 ${a?"text-base":"text-lg"}`},"Intelligence Gap Analysis"),React.createElement("p",{className:`text-gray-500 mx-auto mb-4 ${a?"text-sm max-w-xs":"max-w-md mb-6"}`},a?"Analyze your knowledge base to see what's missing.":"Analyze your client's knowledge base to identify gaps and get a grade indicating readiness for high-quality email calendar generation."),React.createElement("div",{className:"text-sm text-gray-400"},"Click ",a?'"Full Analysis" or "Quick"':'"Run Full Analysis" or "Quick Assessment"'," above to begin"))):React.createElement(X,{icon:"user-x",title:"No Client Selected",description:a?"Select a client above.":"Please select a client from the dropdown above to analyze their intelligence."})}function We({dimKey:t,dim:e,requirements:a,isExpanded:n,onToggle:i,getGradeColor:y,getImportanceColor:C,clientId:d,toast:h,quickCaptureText:l,setQuickCaptureText:u,uploadingField:p,onQuickCapture:S,isQuickAssessment:N,completedFields:o=new Set}){let m=e.score<100,x=a?.dimensions?.[t]?.fields||[],_=e.fields?.filter(s=>!s.found&&!o.has(s.field_name)).length||0,$=e.fields?.filter(s=>s.found&&s.coverage<80).length||0,T=_>0||$>0||e.gaps?.length>0;return React.createElement("div",{className:`rounded-2xl border ${m?"border-gray-200":"border-green-300"} bg-white overflow-hidden shadow-sm hover:shadow-md transition-shadow`},React.createElement("div",{className:"p-5"},React.createElement("div",{className:"flex items-center justify-between mb-3"},React.createElement("span",{className:"font-semibold text-gray-900"},e.display_name),React.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-bold ${y(e.grade)}`},e.grade," \u2022 ",e.score,"%")),React.createElement("div",{className:"relative h-2 bg-gray-100 rounded-full overflow-hidden"},React.createElement("div",{className:`absolute inset-y-0 left-0 rounded-full transition-all duration-500 ${e.score>=90?"bg-green-500":e.score>=70?"bg-blue-500":e.score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${e.score}%`}})),React.createElement("div",{className:"mt-2 flex justify-between text-xs text-gray-500"},React.createElement("span",null,"Weight: ",(e.weight*100).toFixed(0),"%"),React.createElement("span",null,e.earned_points,"/",e.max_points," points")),e.fields&&React.createElement("div",{className:"mt-4 flex flex-wrap gap-2"},e.fields.filter(s=>s.found&&s.coverage>=80).map((s,b)=>React.createElement("span",{key:b,className:"text-xs px-2.5 py-1 bg-green-50 text-green-700 rounded-lg font-medium flex items-center gap-1"},React.createElement(r,{name:"check",className:"h-3 w-3"}),s.display_name)),e.fields.filter(s=>s.found&&s.coverage<80).map((s,b)=>React.createElement("span",{key:b,className:"text-xs px-2.5 py-1 bg-yellow-50 text-yellow-700 rounded-lg font-medium flex items-center gap-1"},React.createElement(r,{name:"check",className:"h-3 w-3"}),s.display_name,React.createElement("span",{className:"text-yellow-500 text-[10px]"},"(",Math.round(s.coverage),"%)"))),e.fields.filter(s=>!s.found).map((s,b)=>React.createElement("span",{key:b,className:`text-xs px-2.5 py-1 rounded-lg font-medium flex items-center gap-1 ${o.has(s.field_name)?"bg-blue-50 text-blue-700":"bg-red-50 text-red-700"}`},React.createElement(r,{name:o.has(s.field_name)?"clock":"x",className:"h-3 w-3"}),s.display_name,o.has(s.field_name)&&React.createElement("span",{className:"text-[10px]"},"(pending)"))))),m&&T&&React.createElement("button",{onClick:i,className:"w-full px-5 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 border-t border-gray-100 text-sm font-medium text-blue-700 hover:from-blue-100 hover:to-indigo-100 transition-all flex items-center justify-center gap-2"},React.createElement(r,{name:n?"chevron-up":"plus-circle",className:"h-4 w-4"}),n?"Collapse":_>0?`Add ${_} Missing Field${_>1?"s":""} (+${Math.round(100-e.score)}%)`:`Improve ${$} Field${$>1?"s":""} (+${Math.round(100-e.score)}%)`),n&&m&&React.createElement("div",{className:"p-5 border-t border-gray-100 bg-gradient-to-b from-gray-50 to-white animate-fade-in"},e.fields&&e.fields.length>0&&React.createElement("div",{className:"mb-4 space-y-2"},React.createElement("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Field Coverage"),e.fields.map((s,b)=>React.createElement("div",{key:b,className:"flex items-center gap-3"},React.createElement("span",{className:"text-xs text-gray-700 w-40 truncate",title:s.display_name},s.display_name),React.createElement("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden"},React.createElement("div",{className:`h-full rounded-full ${s.coverage>=80?"bg-green-400":s.coverage>=50?"bg-yellow-400":"bg-red-400"}`,style:{width:`${Math.min(s.coverage,100)}%`}})),React.createElement("span",{className:`text-xs font-medium w-10 text-right ${s.coverage>=80?"text-green-600":s.coverage>=50?"text-yellow-600":"text-red-600"}`},Math.round(s.coverage),"%")))),e.gaps?.length>0&&React.createElement("div",{className:"space-y-4"},e.gaps.filter(s=>!o.has(s.field_name)).map((s,b)=>React.createElement(ce,{key:b,fieldName:s.field_name,displayName:s.display_name,prompt:s.quick_capture_prompt,expectedImprovement:s.expected_improvement,importance:s.importance,value:l[s.field_name]||"",onChange:w=>u(M=>({...M,[s.field_name]:w})),onSubmit:w=>S(s.field_name,l[s.field_name],w),isLoading:p===s.field_name,getImportanceColor:C}))),N&&x.length>0&&React.createElement("details",{className:"mt-4 text-sm"},React.createElement("summary",{className:"cursor-pointer text-gray-500 hover:text-gray-700 flex items-center gap-2"},React.createElement(r,{name:"info",className:"h-4 w-4"}),"Keywords we searched for"),React.createElement("div",{className:"mt-2 p-3 bg-gray-50 rounded-xl text-xs space-y-2"},x.filter(s=>!e.fields?.find(b=>b.field_name===s.name)?.found).map((s,b)=>React.createElement("div",{key:b},React.createElement("span",{className:"font-medium text-gray-700"},s.display_name,":")," ",React.createElement("span",{className:"text-gray-500"},s.detection_keywords?.slice(0,6).join(", "))))))))}function Je({gap:t,index:e,isExpanded:a,onToggle:n,getImportanceColor:i,clientId:y,toast:C,quickCaptureText:d,setQuickCaptureText:h,uploadingField:l,onQuickCapture:u,requirements:p,isQuickAssessment:S,isCompleted:N=!1}){let m=(()=>{if(!p?.dimensions)return null;for(let[x,_]of Object.entries(p.dimensions)){let $=_.fields?.find(T=>T.name===t.field_name);if($)return $}return null})();return N?React.createElement("div",{className:"rounded-2xl border border-green-200 bg-green-50 p-4 flex items-center gap-4"},React.createElement("div",{className:"flex-shrink-0 w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center"},React.createElement(r,{name:"check",className:"h-5 w-5 text-green-600"})),React.createElement("div",{className:"flex-1"},React.createElement("span",{className:"font-medium text-green-800"},t.display_name),React.createElement("p",{className:"text-sm text-green-600"},"Added! Re-analyze to update score.")),React.createElement("span",{className:"text-green-600 font-semibold"},"+",t.expected_improvement,"%")):React.createElement("div",{className:"rounded-2xl border border-red-200 bg-gradient-to-br from-red-50 to-orange-50 overflow-hidden shadow-sm"},React.createElement("div",{className:"p-5"},React.createElement("div",{className:"flex items-start justify-between gap-4"},React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"flex items-center gap-2 mb-2"},React.createElement("span",{className:"font-semibold text-gray-900"},t.display_name),React.createElement("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${i(t.importance)}`},t.importance)),React.createElement("p",{className:"text-sm text-gray-600"},t.impact)),React.createElement("div",{className:"text-right"},React.createElement("div",{className:"text-xs text-gray-500 uppercase tracking-wide"},t.dimension),React.createElement("div",{className:"text-lg font-bold text-green-600"},"+",t.expected_improvement,"%")))),React.createElement("button",{onClick:n,className:"w-full px-5 py-3 bg-gradient-to-r from-red-100 to-orange-100 border-t border-red-200 text-sm font-semibold text-red-700 hover:from-red-200 hover:to-orange-200 transition-all flex items-center justify-center gap-2"},React.createElement(r,{name:a?"chevron-up":"plus",className:"h-4 w-4"}),a?"Collapse":"Add This Information"),a&&React.createElement("div",{className:"p-5 border-t border-red-200 bg-white animate-fade-in"},React.createElement(ce,{fieldName:t.field_name,displayName:t.display_name,prompt:t.quick_capture_prompt,expectedImprovement:t.expected_improvement,importance:t.importance,value:d[t.field_name]||"",onChange:x=>h(_=>({..._,[t.field_name]:x})),onSubmit:x=>u(t.field_name,d[t.field_name],x),isLoading:l===t.field_name,getImportanceColor:i})))}function Ke({dimKey:t,dim:e,requirements:a,isExpanded:n,onToggle:i,clientId:y,toast:C,quickCaptureText:d,setQuickCaptureText:h,uploadingField:l,onQuickCapture:u,completedFields:p=new Set}){let S=e.coverage<100,o=(a?.dimensions?.[t]?.fields||[]).filter(m=>{let x=e.fields_detail?.find(_=>_.field_name===m.name);return(!x||!x.found)&&!p.has(m.name)});return React.createElement("div",{className:`rounded-2xl border ${S?"border-gray-200":"border-green-300"} bg-white overflow-hidden shadow-sm hover:shadow-md transition-shadow`},React.createElement("div",{className:"p-5"},React.createElement("div",{className:"flex items-center justify-between mb-3"},React.createElement("span",{className:"font-semibold text-gray-900"},e.display_name),React.createElement("span",{className:"text-sm font-medium text-gray-500"},e.fields_found,"/",e.total_fields," fields")),React.createElement("div",{className:"relative h-2 bg-gray-100 rounded-full overflow-hidden"},React.createElement("div",{className:`absolute inset-y-0 left-0 rounded-full transition-all duration-500 ${e.coverage>=90?"bg-green-500":e.coverage>=70?"bg-blue-500":e.coverage>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${e.coverage}%`}})),React.createElement("div",{className:"mt-2 text-xs text-gray-500 text-right"},e.coverage,"% coverage")),S&&o.length>0&&React.createElement("button",{onClick:i,className:"w-full px-5 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 border-t border-gray-100 text-sm font-medium text-blue-700 hover:from-blue-100 hover:to-indigo-100 transition-all flex items-center justify-center gap-2"},React.createElement(r,{name:n?"chevron-up":"plus-circle",className:"h-4 w-4"}),n?"Collapse":`Add ${o.length} Missing Field${o.length>1?"s":""}`),n&&S&&React.createElement("div",{className:"p-5 border-t border-gray-100 bg-gradient-to-b from-gray-50 to-white animate-fade-in"},React.createElement("div",{className:"space-y-4"},o.map((m,x)=>React.createElement("div",{key:x,className:"p-4 rounded-xl bg-white border border-gray-200 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between mb-2"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"font-medium text-gray-900"},m.display_name),React.createElement("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${m.importance==="critical"?"bg-red-100 text-red-700":m.importance==="high"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"}`},m.importance)),React.createElement("span",{className:"text-xs text-gray-400"},m.points," pts")),React.createElement("p",{className:"text-sm text-gray-600 mb-3"},m.description),m.quick_capture_prompt&&React.createElement(ce,{fieldName:m.name,displayName:m.display_name,prompt:m.quick_capture_prompt,expectedImprovement:Math.round(m.points*(a?.dimensions?.[t]?.weight||.1)),importance:m.importance,value:d[m.name]||"",onChange:_=>h($=>({...$,[m.name]:_})),onSubmit:_=>u(m.name,d[m.name],_),isLoading:l===m.name,detectionKeywords:m.detection_keywords}))))))}function ce({fieldName:t,displayName:e,prompt:a,expectedImprovement:n,importance:i,value:y,onChange:C,onSubmit:d,isLoading:h,getImportanceColor:l,detectionKeywords:u}){let[p,S]=j("text"),[N,o]=j(null),m=React.useRef(null),x=T=>{let s=T.target.files?.[0];s&&o(s)},_=()=>{p==="file"&&N?(d(N),o(null)):p==="text"&&y?.trim()&&d(null)},$=p==="text"&&y?.trim()||p==="file"&&N;return React.createElement("div",{className:"animate-fade-in"},a&&React.createElement("div",{className:"mb-3 p-3 rounded-xl bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100"},React.createElement("div",{className:"text-xs text-blue-600 font-semibold mb-1 flex items-center gap-1"},React.createElement(r,{name:"help-circle",className:"h-3.5 w-3.5"}),"Answer this:"),React.createElement("div",{className:"text-sm text-blue-800"},a)),React.createElement("div",{className:"flex gap-2 mb-3"},React.createElement("button",{onClick:()=>S("text"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ${p==="text"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`},React.createElement(r,{name:"type",className:"h-4 w-4"}),"Type Answer"),React.createElement("button",{onClick:()=>S("file"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ${p==="file"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`},React.createElement(r,{name:"upload",className:"h-4 w-4"}),"Upload File")),p==="text"&&React.createElement("div",{className:"rounded-xl border border-gray-200 bg-white overflow-hidden"},React.createElement("textarea",{value:y,onChange:T=>C(T.target.value),placeholder:`Enter information about ${e}...`,className:"w-full min-h-[100px] px-4 py-3 text-sm focus:outline-none resize-y border-none",disabled:h})),p==="file"&&React.createElement("div",{onClick:()=>m.current?.click(),className:`rounded-xl border-2 border-dashed p-6 text-center cursor-pointer transition-all ${N?"border-green-300 bg-green-50":"border-gray-300 hover:border-blue-400 hover:bg-blue-50"}`},React.createElement("input",{ref:m,type:"file",onChange:x,className:"hidden",accept:".pdf,.doc,.docx,.txt,.md,.csv,.json"}),N?React.createElement("div",{className:"flex items-center justify-center gap-3"},React.createElement("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center"},React.createElement(r,{name:"file-text",className:"h-5 w-5 text-green-600"})),React.createElement("div",{className:"text-left"},React.createElement("div",{className:"font-medium text-green-800"},N.name),React.createElement("div",{className:"text-xs text-green-600"},(N.size/1024).toFixed(1)," KB")),React.createElement("button",{onClick:T=>{T.stopPropagation(),o(null)},className:"p-1 hover:bg-green-200 rounded-full"},React.createElement(r,{name:"x",className:"h-4 w-4 text-green-700"}))):React.createElement(React.Fragment,null,React.createElement(r,{name:"upload-cloud",className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),React.createElement("div",{className:"text-sm text-gray-600"},"Click to upload or drag & drop"),React.createElement("div",{className:"text-xs text-gray-400 mt-1"},"PDF, DOC, TXT, CSV (max 10MB)"))),React.createElement("div",{className:"flex items-center justify-between mt-3"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"text-sm font-semibold text-green-600"},"+",n,"%"),React.createElement("span",{className:"text-xs text-gray-500"},"score improvement")),React.createElement("button",{onClick:_,disabled:!$||h,className:"h-10 px-5 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-md hover:shadow-lg transition-all"},h?React.createElement(React.Fragment,null,React.createElement("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},React.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),React.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})),"Saving..."):React.createElement(React.Fragment,null,React.createElement(r,{name:"check",className:"h-4 w-4"}),"Save & Improve"))),u?.length>0&&React.createElement("details",{className:"mt-3 text-xs"},React.createElement("summary",{className:"cursor-pointer text-gray-400 hover:text-gray-600"},"Keywords we search for..."),React.createElement("div",{className:"mt-1 flex flex-wrap gap-1"},u.slice(0,8).map((T,s)=>React.createElement("span",{key:s,className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded"},T)))))}function Xe({onUpload:t,uploading:e}){let[a,n]=j(""),i=()=>{a.trim()&&(t(a),n(""))};return React.createElement("div",{className:"space-y-3"},React.createElement("textarea",{value:a,onChange:y=>n(y.target.value),placeholder:"Paste your text content here...",className:"w-full min-h-[120px] rounded-md border border-input bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring resize-y",disabled:e}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-muted-foreground"},a.length.toLocaleString()," characters"),React.createElement(B,{onClick:i,disabled:!a.trim()||e,loading:e},"Upload Text")))}var Ye=document.getElementById("root"),Ze=ReactDOM.createRoot(Ye);Ze.render(React.createElement(qe,null));})();
